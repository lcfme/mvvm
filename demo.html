<div id="app">
  <div mvvm-bind="myVar"></div>
  <div mvvm-click="changeText('it works')">改变内容</div>
</div>

<script>
  const data = {
    myVar: "Hello World",
    changeText() {
      this.myVar = "It works";
    }
  };

  const reg = /mvvm-(\w+)/;

  function expr(expr, scope) {
    try {
      with (scope) {
        return eval(expr);
      }
    } catch (err) {
      console.error(err);
      return undefined;
    }
  }
  function traverse(el) {
    const attrs = el.attributes;
    Array.prototype.slice.call(attrs).forEach(attr => {
      const m = attr.name.match(reg);
      if (!m) return;
      const dirName = m[1];
      const dirValue = attr.value;

      switch (dirName) {
        case "bind":
          el.innerHTML = expr(dirValue, data);
        case "click":
          el.addEventListener("click", e => {
            expr(dirValue, data);
          });
      }
    });
    if (el.children) {
      Array.prototype.slice.call(el.children).forEach(el => {
        traverse(el);
      });
    }
  }
  traverse(document.querySelector("#app"));
</script>
